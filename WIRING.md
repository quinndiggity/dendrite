# Wiring

The diagram is incomplete. The following things aren't shown on the diagram:

 - [ ] Device Messages
 - [ ] User Profiles
 - [ ] Notification Counts
 - [ ] Sending federation.
 - [ ] Other things that aren't shown on the diagram.

Diagram:


    W -> Writer
    S -> Server/Store/Service/Something/Stuff
    R -> Reader

               +---+                                                    +---+                              +---+
    +----------| W |                                         +----------| S |                     +--------| R |
    |          +---+                                         | Receipts +---+                     | Client +---+
    | Federation |>=========================================>| Server     |>=====================>| Sync     |
    | Sender     |                                           |            |                       |          |
    |            |                +---+            +---+     |            |                +---+  |          |
    |            |   +------------| W |     +------| S |     |            |       +--------| R |  |          |
    |            |   | Federation +---+     | Room +---+     |            |       | Client +---+  |          |
    |            |   | Backfill     |>=====>| Server |>=====>|            |>=====>| Push     |    |          |
    |            |   +--------------+       |        |       +------------+       |          |    |          |
    |            |                          |        |                            |          |    |          |
    |            |                          |        |>==========================>|          |    |          |
    |            |                          |        |                            +----------+    |          |
    |            |                          |        |                                            |          |
    |            |                          |        |                                     +---+  |          |
    |            |                          |        |                            +--------| R |  |          |
    |            |                          |        |                            | Client +---+  |          |
    |            |>========================>|        |>==========================>| Search   |    |          |
    |            |                          |        |                            |          |    |          |
    |            |                          |        |                            +----------+    |          |
    |            |                          |        |                                            |          |
    |            |                          |        |>==========================================>|          |
    |            |                          |        |                                            |          |
    |            |                +---+     |        |                  +---+                     |          |
    |            |       +--------| W |     |        |       +----------| S |                     |          |
    |            |       | Client +---+     |        |       | Presence +---+                     |          |
    |            |       | Room     |>=====>|        |>=====>| Server     |>=====================>|          |
    |            |       | send     |       +--------+       |            |                       |          |
    |            |       |          |                        |            |                       |          |
    |            |       |          |>======================>|            |<=====================<|          |
    |            |       +----------+                        |            |                       |          |
    |            |                                           |            |                       |          |
    |            |                                 +---+     |            |                       |          |
    |            |                        +--------| W |     |            |                       |          |
    |            |                        | Client +---+     |            |                       |          |
    |            |                        | Presence |>=====>|            |                       |          |
    |            |                        | Setter   |       |            |                       |          |
    |            |                        +----------+       |            |                       |          |
    |            |                                           |            |                       |          |
    |            |                                           |            |                       |          |
    |            |>=========================================>|            |                       |          |
    |            |                                           +------------+                       |          |
    |            |                                                                                |          |
    |            |                                                      +---+                     |          |
    |            |                                           +----------| S |                     |          |
    |            |                                           | Typing   +---+                     |          |
    |            |>=========================================>| Server     |>=====================>|          |
    +------------+                                           |            |                       +----------+
                                                   +---+     |            |
                                          +--------| W |     |            |
                                          | Client +---+     |            |
                                          | Typing   |>=====>|            |
                                          | Setter   |       |            |
                                          +----------+       +------------+
